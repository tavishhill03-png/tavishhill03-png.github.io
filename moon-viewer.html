<script type="module">
  import * as THREE from "./three/three.module.js";

  console.log("ðŸ‘ Three.js imported:", THREE);

  const container = document.getElementById("container");

  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setPixelRatio(window.devicePixelRatio || 1);
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.outputEncoding = THREE.sRGBEncoding;
  container.appendChild(renderer.domElement);

  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0x000000);

  const camera = new THREE.PerspectiveCamera(
    45,
    window.innerWidth / window.innerHeight,
    0.1,
    1000
  );
  camera.position.set(0, 0, 3);

  const ambient = new THREE.AmbientLight(0xffffff, 0.05);
  scene.add(ambient);

  const sunLight = new THREE.DirectionalLight(0xffffff, 1.4);
  sunLight.position.set(5, 0, 0);
  scene.add(sunLight);

  const geometry = new THREE.SphereGeometry(1, 64, 64);
  const material = new THREE.MeshStandardMaterial({
    color: 0xffffff,
    roughness: 1.0,
    metalness: 0.0
  });
  const moon = new THREE.Mesh(geometry, material);
  scene.add(moon);

  console.log("ðŸŒ• Sphere added");

  // ---- Simple drag-to-rotate controls ----
  let isDragging = false;
  let prevX = 0;
  let prevY = 0;

  renderer.domElement.addEventListener("pointerdown", (e) => {
    isDragging = true;
    prevX = e.clientX;
    prevY = e.clientY;
  });

  window.addEventListener("pointerup", () => {
    isDragging = false;
  });

  window.addEventListener("pointermove", (e) => {
    if (!isDragging) return;
    const deltaX = (e.clientX - prevX) * 0.01;
    const deltaY = (e.clientY - prevY) * 0.01;
    moon.rotation.y += deltaX;
    moon.rotation.x += deltaY;
    prevX = e.clientX;
    prevY = e.clientY;
  });

  function animate() {
    requestAnimationFrame(animate);
    moon.rotation.y += 0.003; // faster spin to see motion
    moon.rotation.x += 0.001; // tilt to show shading change
    renderer.render(scene, camera);
  }
  animate();

  window.addEventListener("resize", () => {
    const w = window.innerWidth;
    const h = window.innerHeight;
    renderer.setSize(w, h);
    camera.aspect = w / h;
    camera.updateProjectionMatrix();
  });
</script>
